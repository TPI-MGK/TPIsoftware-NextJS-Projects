# 第四章：建立版面配置與頁面

到目前為止，您的應用程式只有一個首頁。接下來，讓我們學習如何使用版面配置 (layouts) 和頁面 (pages) 來建立更多的路由。

## 在本章中...

以下是我們將涵蓋的主題：

- 使用檔案系統路由 (file-system routing) 建立儀表板路由。
- 理解在建立新的路由區段時，資料夾和檔案所扮演的角色。
- 建立一個可以在多個儀表板頁面之間共享的巢狀版面配置。
- 理解什麼是同位性 (colocation)、部分渲染 (partial rendering) 以及根版面配置 (root layout)。

## 巢狀路由 (Nested Routing)

Next.js 使用檔案系統路由 (file-system routing)，其中資料夾用於建立巢狀路由。每個資料夾代表一個路由區段 (route segment)，並對應到一個 URL 區段 (URL segment)。

![資料夾到 URL 區段的對應圖](https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Flearn%2Fdark%2Ffolders-to-url-segments.png&w=3840&q=75)

您可以使用 `layout.tsx` 和 `page.tsx` 檔案為每個路由建立獨立的使用者介面。

`page.tsx` 是一個特殊的 Next.js 檔案，它導出一個 React 元件，並且是路由可訪問的必要條件。在您的應用程式中，您已經有一個頁面檔案：`/app/page.tsx` —— 這就是與路由 `/` 相關聯的首頁。

要建立一個巢狀路由，您可以將資料夾彼此巢狀，並在其中添加 `page.tsx` 檔案。例如：

![儀表板路由結構圖](https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Flearn%2Fdark%2Fdashboard-route.png&w=3840&q=75)

`/app/dashboard/page.tsx` 與 `/dashboard` 路徑相關聯。讓我們建立這個頁面來看看它是如何運作的！

## 建立儀表板頁面

1.  在 `/app` 內部建立一個新資料夾，命名為 `dashboard`。
2.  然後，在 `dashboard` 資料夾內部建立一個新的 `page.tsx` 檔案，內容如下：

    `/app/dashboard/page.tsx`

    ```tsx
    export default function Page() {
      return <p>Dashboard Page</p>;
    }
    ```

現在，請確保開發伺服器正在運行，並訪問 `http://localhost:3000/dashboard`。您應該會看到「Dashboard Page」的文字。

這就是您在 Next.js 中建立不同頁面的方法：使用資料夾建立新的路由區段，並在其中添加一個頁面檔案。

透過為頁面檔案設定特殊名稱，Next.js 允許您將 UI 元件、測試檔案以及其他相關程式碼與您的路由同位 (colocate)。只有頁面檔案內的內容才能公開訪問。例如，`/ui` 和 `/lib` 資料夾就與您的路由一同被同位在 `/app` 資料夾中。

## 練習：建立儀表板子頁面

讓我們練習建立更多路由。在您的儀表板中，再建立兩個頁面：

- **客戶頁面 (Customers Page)**：該頁面應可透過 `http://localhost:3000/dashboard/customers` 訪問。目前，它應返回一個 `<p>Customers Page</p>` 元素。
- **發票頁面 (Invoices Page)**：發票頁面應可透過 `http://localhost:3000/dashboard/invoices` 訪問。目前，也返回一個 `<p>Invoices Page</p>` 元素。

您應該具有以下資料夾結構：

![路由解決方案資料夾結構圖](https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Flearn%2Fdark%2Frouting-solution.png&w=3840&q=75)

**客戶頁面：**
`/app/dashboard/customers/page.tsx`

```tsx
export default function Page() {
  return <p>Customers Page</p>;
}
```

**發票頁面：**
`/app/dashboard/invoices/page.tsx`

```tsx
export default function Page() {
  return <p>Invoices Page</p>;
}
```

</details>

## 建立儀表板版面配置

儀表板通常會有一些在多個頁面之間共享的導航。在 Next.js 中，您可以使用特殊的 `layout.tsx` 檔案來建立在多個頁面之間共享的 UI。讓我們為儀表板頁面建立一個版面配置！

在 `/dashboard` 資料夾內，添加一個名為 `layout.tsx` 的新檔案，並貼上以下程式碼：

`/app/dashboard/layout.tsx`

```tsx
import SideNav from "@/app/ui/dashboard/sidenav";

export default function Layout({ children }: { children: React.ReactNode }) {
  return (
    <div className="flex h-screen flex-col md:flex-row md:overflow-hidden">
      <div className="w-full flex-none md:w-64">
        <SideNav />
      </div>
      <div className="grow p-6 md:overflow-y-auto md:p-12">{children}</div>
    </div>
  );
}
```

這段程式碼中有幾件事情正在發生，讓我們來分解一下：

- 首先，您將 `<SideNav />` 元件匯入到您的版面配置中。您匯入到此檔案的任何元件都將成為版面配置的一部分。
- `<Layout />` 元件接收一個 `children` 屬性 (prop)。這個 `children` 可以是一個頁面，也可以是另一個版面配置。在您的案例中，`/dashboard` 內部頁面將自動巢狀在 `<Layout />` 內部，如下所示：

![共享版面配置結構圖](https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Flearn%2Fdark%2Fshared-layout.png&w=3840&q=75)

儲存您的變更並檢查您的 localhost，確保一切正常運作。您應該會看到以下內容：

Next.js 中使用版面配置的一個好處是，在導航時，只有頁面元件會更新，而版面配置不會重新渲染。這稱為**部分渲染 (partial rendering)**，它在頁面轉換時會保留版面配置中的客戶端 React 狀態。

![儀表板部分渲染流程圖](https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Flearn%2Fdark%2Fpartial-rendering-dashboard.png&w=3840&q=75)

## 根版面配置 (Root Layout)

在第三章中，您將 Inter 字體匯入到另一個版面配置中：`/app/layout.tsx`。提醒一下：

`/app/layout.tsx`

```tsx
import "@/app/ui/global.css";
import { inter } from "@/app/ui/fonts";

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className={`${inter.className} antialiased`}>{children}</body>
    </html>
  );
}
```

這就是**根版面配置 (root layout)**，它是每個 Next.js 應用程式所必需的。您添加到根版面配置中的任何 UI 都將在應用程式的所有頁面之間共享。您可以使用根版面配置修改您的 `<html>` 和 `<body>` 標籤，並添加元資料 (metadata)（您將在稍後的章節中了解更多關於元資料的資訊）。

由於您剛剛建立的新版面配置 (`/app/dashboard/layout.tsx`) 僅適用於儀表板頁面，因此您無需在上面的根版面配置中添加任何 UI。

```

```
