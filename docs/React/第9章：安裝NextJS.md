# 第 9 章：安裝 Next.js

當您在專案中使用 Next.js 時，您不再需要從 unpkg.com 載入 `react` 和 `react-dom` 指令碼。相反地，您可以使用 npm 或您偏好的套件管理器在本機安裝這些套件。

如果您使用的版本比上面顯示的更新，請不用擔心，只要您安裝了 `next`、`react` 和 `react-dom` 套件，就可以了。
您還會注意到一個名為 `package-lock.json` 的新檔案，其中包含每個套件確切版本的詳細資訊。
回到 `index.html` 檔案，您可以刪除以下程式碼：

- `<html>` 和 `<body>` 標籤。
- `id` 為 `app` 的 `<div>` 元素。
- `react` 和 `react-dom` 指令碼，因為您已經使用 NPM 安裝了它們。
- Babel 指令碼，因為 Next.js 有一個編譯器可以將 JSX 轉換為瀏覽器可以理解的有效 JavaScript。
- `<script type="text/jsx">` 標籤。
- `document.getElementById()` 和 `ReactDom.createRoot()` 方法。
- `React.useState(0)` 函式中的 `React.` 部分。

刪除上述程式碼後，在檔案頂部新增以下匯入：

**index.html**

```javascript
import { useState } from "react";
```

您的程式碼應該看起來像這樣：

**index.html**

```javascript
import { useState } from "react";

function Header({ title }) {
  return <h1>{title ? title : "Default title"}</h1>;
}

function HomePage() {
  const names = ["Ada Lovelace", "Grace Hopper", "Margaret Hamilton"];

  const [likes, setLikes] = useState(0);

  function handleClick() {
    setLikes(likes + 1);
  }

  return (
    <div>
      <Header title="Develop. Preview. Ship." />
      <ul>
        {names.map((name) => (
          <li key={name}>{name}</li>
        ))}
      </ul>

      <button onClick={handleClick}>Like ({likes})</button>
    </div>
  );
}
```

HTML 檔案中剩下的唯一程式碼是 JSX，所以您可以將檔案類型從 `.html` 更改為 `.js` 或 `.jsx`。

## 建立您的第一個頁面

Next.js 使用**檔案系統路由**。這意味著您可以使用資料夾和檔案來定義應用程式的路由，而不是使用程式碼。
以下是如何在 Next.js 中建立您的第一個頁面：

1. 建立一個名為 `app` 的新資料夾，並將 `index.js` 檔案移入其中。
2. 將您的 `index.js` 檔案重新命名為 `page.js`。這將是您應用程式的主頁面。
3. 在您的 `<HomePage>` 元件前加上 `export default`，以幫助 Next.js 區分哪個元件要作為頁面的主要元件來渲染。

**app/page.js**

```javascript
import { useState } from "react";

function Header({ title }) {
  return <h1>{title ? title : "Default title"}</h1>;
}

export default function HomePage() {
  // ...
}
```

## 執行開發伺服器

接下來，讓我們執行您的開發伺服器，以便您在開發時可以看到新頁面的變更。將 `"next dev"` 指令碼新增到您的 `package.json` 檔案中：

**package.json**

```json
{
  "scripts": {
    "dev": "next dev"
  },
  "dependencies": {
    "next": "^14.0.3",
    "react": "^18.3.1",
    "react-dom": "^18.3.1"
  }
}
```

透過在終端機中執行 `npm run dev` 來檢查會發生什麼。您會注意到兩件事：

1. 當您導覽到 `localhost:3000` 時，您應該會看到以下錯誤：

![](https://nextjs.org/_next/image?url=https%3A%2F%2Fnextjs.org%2Fdocs%2Fimages%2Flearn%2Fgetting-started-with-the-app-router%2Fbroken-like-button.png&w=1920&q=75)

這是因為 Next.js 使用 **React 伺服器元件 (Server Components)**，這是一個允許 React 在伺服器上渲染的新功能。伺服器元件不支援 `useState`，所以您需要改用**客戶端元件 (Client Component)**。
在下一章中，我們將討論伺服器和客戶端元件之間的主要區別並修復此錯誤。 2. 一個名為 `layout.js` 的新檔案已自動在 `app` 資料夾內建立。這是您應用程式的主要佈局。您可以用它來新增跨所有頁面共享的 UI 元素（例如導覽列、頁尾等）。

**/app/layout.js**

```javascript
export const metadata = {
  title: "Next.js",
  description: "Generated by Next.js",
};

export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  );
}
```

## 總結

回顧目前的遷移過程，您可能已經開始感受到使用 Next.js 的好處：

- 您移除了 React 和 Babel 指令碼；體驗到您不再需要考慮的複雜工具和配置。
- 您建立了您的第一個頁面。

## 額外閱讀：

- [Next.js 路由基礎](https://nextjs.org/docs/app/building-your-application/routing)
- [定義路由](https://nextjs.org/docs/app/building-your-application/routing/defining-routes)
- [頁面和佈局](https://nextjs.org/docs/app/building-your-application/routing/pages-and-layouts)
